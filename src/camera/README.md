# gaze

カメラに接続，画像を取得など行うプログラム

## camera.cpp

- `Camera`

    カメラに接続，画像の取得などを行うクラス．Foveに搭載された目の画像を取得するカメラ，ステレオカメラ両方に使用．

    | デバイス | デバイス名 |
    | --------- | ----------- |
    | Fove | FOVE Eyes: FOVE Eyes |
    | ステレオカメラ | PayCam: PayCam |

    ```cpp
    // コンストラクタ
    Camera Camera(デバイス名);

    while(true){
        // カメラへの接続確認
        if(camera.check_device_opened()){
            // 画像の取得
            cv::Mat frame = camera.get_frame();
        }
    }
    ```

    で使用可能．
    以下にメンバ関数の説明を述べる．

  - `Camera::Camera(std::string dev_name)`

    カメラをデバイス名で指定して開く．画像の取得はOpenCVを利用しているが，OpenCVでは複数のカメラを番号でしか識別できず，番号はカメラをPCに接続した順番で変わるため，不便であった．
    そこで，Video for Linux (V4L2)でPCに接続されたカメラのデバイス名一覧を取得し，引数で渡したデバイス名と一致したカメラがあった場合は，そのIDをメンバ変数で保持するようにしている．

    | 入力 | 出力 |
    | --------- | ----------- |
    | デバイス名 | なし |

  - `void Camera::capture(void)`

    カメラから画像を取得して，cv::Mat型のメンバ変数に格納し続ける．while文を使用しているため，この関数を実行すると次の行以降に進まなくなる．
    そのため，別スレッドを立てて実行すること．

    | 入力 | 出力 |
    | --------- | ----------- |
    | なし | なし |

  - `bool Camera::check_device_opened(void)`

    カメラに接続できているかを確認するための関数．コンストラクタを実行してから，実際にカメラに接続されて，画像がメンバ変数に格納されるまでにタイムラグがある．
    その間に，`get_frame()`で画像を取得しようとするとコアダンプでエラーとなる．
    そのため，`get_frame()`で画像を取得する際は，必ずこの関数を実行してカメラに接続できていることを確認すること．

    | 入力 | 出力 |
    | --------- | ----------- |
    | なし | カメラに接続されているかのtrue/false |

  - `cv::Mat Camera::get_frame(void)`

    カメラから画像を取得する関数．画像を格納しているメンバ変数はプライベート変数なので，関数を容易してAPIのようにして画像を取得する．

    | 入力 | 出力 |
    | --------- | ----------- |
    | なし | カメラから取得した画像 |
